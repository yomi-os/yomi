[alias]
x = "run --package xtask --"

[target.x86_64-unknown-none]
rustflags = [
    "-C", "link-arg=--nmagic",
    "-C", "link-arg=--no-dynamic-linker",
    "-C", "link-arg=-Tkernel/linker.ld",
    "-C", "relocation-model=static",
    "-C", "force-frame-pointers=yes",
]

# Platform-specific linker configuration
# Windows: Use ld.lld from LLVM (install: winget install LLVM.LLVM)
[target.x86_64-unknown-none.'cfg(host_os = "windows")']
linker = "C:\\Program Files\\LLVM\\bin\\ld.lld.exe"

# Linux/macOS: Use system ld or lld
[target.x86_64-unknown-none.'cfg(not(host_os = "windows"))']
linker = "ld.lld"
